<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.onetrillion.trip.service.mapper.UserResMapper">

	<insert id="userResInsert">
		<![CDATA[
			INSERT INTO TRIL_USERRESERVATION(URES_SEQ, PD_SEQ, PD_NAME, PD_STARTDATE, PD_ENDDATE,
				 ADULT_NUM, TEENAGER_NUM, PET_NUM, ADULT_PRICE, TEENAGER_PRICE, PET_PRICE, RES_PRICE, RES_PEOPLE,
				 RES_NAME, RES_BIRTH, RES_EMAIL, RES_COMMENT, U_ID, RES_PHONE)
				values(URES_SEQ.nextVal,#{pd_seq},#{pd_name},#{pd_startDate},#{pd_endDate},
				#{adult_num},#{teenager_num},#{pet_num},#{adult_price},#{teenager_price},#{pet_price},#{res_price},#{res_people},
				#{res_name},#{res_birth},#{res_email},#{res_comment},#{u_id},#{res_phone})
		]]>
	</insert>

	<select resultType="com.onetrillion.trip.userRes.UserResDTO" id="userSelectAll">
		<![CDATA[
		 SELECT * FROM Tril_USERRESERVATION ORDER BY ures_seq ASC
		]]>
	</select>
	
	<select resultType="com.onetrillion.trip.userRes.UserResDTO" id="userResDetail">
	
	<![CDATA[
	      select * from Tril_USERRESERVATION where pd_seq=#{pd_seq}]]>
	</select>

	<select resultType="com.onetrillion.trip.userRes.UserResDTO" id="userSelectId">
		<![CDATA[
		SELECT * FROM Tril_USERRESERVATION where u_id=#{u_id} ORDER BY ures_seq ASC
		]]>
	</select>
	
	<select resultType="com.onetrillion.trip.userRes.UserResDTO" id="userResPaging">

	<![CDATA[
		SELECT ures_seq, pd_seq, pd_name, pd_startDate, pd_endDate, adult_num, teenager_num, pet_num, adult_price, teenager_price, pet_price, res_price, res_people, res_name,
		res_birth, res_email, res_comment, u_id, res_phone
		FROM
		(
			SELECT ures_seq, pd_seq, pd_name, pd_startDate, pd_endDate, adult_num, teenager_num, pet_num, adult_price, teenager_price, pet_price, res_price, res_people, res_name,
			res_birth, res_email, res_comment, u_id, res_phone,
			ROW_NUMBER() over(ORDER BY ures_seq ASC) AS rn 
			FROM TRIL_USERRESERVATION
		) WHERE rn BETWEEN #{rowStart} AND #{rowEnd} ORDER  BY ures_seq ASC 
      ]]>
	</select>

	<select resultType="int" id="userResCount">
	
		<![CDATA[
		      select count(ures_seq) from Tril_USERRESERVATION where pd_seq>0
		      ]]>
	</select>



</mapper>
